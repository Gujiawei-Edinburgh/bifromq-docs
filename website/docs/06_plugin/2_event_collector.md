---
sidebar_position: 3
title: "Event Collector"
---

The Event Collector Plugin is designed to capture various events that occur during BifroMQ's execution. By filtering events based on their type, you can focus on the specific events relevant to your needs. This allows you to implement various business functionalities like usage statistics, monitoring, alerts, and more. 

The Plugin's interface is defined in the following Maven module:

```
<dependency>
    <groupId>com.baidu.bifromq</groupId>
    <artifactId>bifromq-plugin-event-collector</artifactId>
    <version>X.Y.Z</version> <!--replace X.Y.Z with the latest version number-->
</dependency>
```

BifroMQ allows you to load and use multiple EventCollector implementations simultaneously. It scans the plugin directory and loads all available implementations. These implementations will be called back concurrently.

For optimal performance, it's recommended to design each EventCollector to focus on a single specific task. To achieve this, EventCollector implementations can leverage the EventType feature to filter out events that are not relevant to their purpose.

## Event Types

The types of event objects generated by BifroMQ during runtime all inherit from
the [Event](https://github.com/bifromqio/bifromq/blob/main/bifromq-plugin/bifromq-plugin-event-collector/src/main/java/com/baidu/bifromq/plugin/eventcollector/Event.java) class. Each specific event class corresponds to
an [EventType](https://github.com/bifromqio/bifromq/blob/main/bifromq-plugin/bifromq-plugin-event-collector/src/main/java/com/baidu/bifromq/plugin/eventcollector/EventType.java) enum, which can be accessed through the `type()` method on the
object, facilitating the implementation of event filtering logic. The `hlc()` method allows for the retrieval of an event object's timestamp. BifroMQ's timestamps are partially ordered, reflecting the sequence in which events occur. This is
particularly useful for handling events in BifroMQ during distributed deployment.

## Plugin Interface

When an event is generated, BifroMQ invokes the Pluginâ€™s `report()` method. The method signature is as follows:

```java
public void report(Event<?> event);
```

This method is called on BifroMQ's worker thread. With the increase in load, a large number of events will be generated. To avoid the creation of a multitude of event objects and excessive memory overhead, the event object passed into this
method will be reused after the method returns. Therefore, when implementing the Event Collector Plugin, it's important to consider the following:

1. Avoid incorporating heavy business logic within the report method to ensure that it returns quickly; otherwise, it may adversely affect BifroMQ's performance.
2. The ownership of the passed-in event does not get transferred. If the business logic is asynchronous and you need to access the content of the event after the report method returns, you should create a shallow copy of the object using
   the `clone()` method before returning.

Please note that efficient handling within the `report()` method is critical for maintaining the performance and scalability of the BifroMQ system.


